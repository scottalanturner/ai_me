# Check your Dockerfil
- Check the main file

# Commit code to github

# AWS - CodeBuild
- Goto the AIME project


# You need to be in an EC2 terminal to do this

sudo apt-get update -y

# install docker
sudo yum install -y docker

# Then with the running EC2 instance (or before running it), attach it to an IAM role with the AmazonEC2ContainerRegistryFullAccess policy

aws ecr get-login-password --region us-east-1 | docker login --username AWS --password-stdin <ECR_repository_URI:image_version>

# start docker
sudo systemctl start docker

# add the ec2 user to the docker group
sudo usermod -a -G docker ec2-user

# Close/reopen the session for new group to take effect



# restart docker
sudo systemctl restart docker

# pull the image
docker pull <ECR_repository_URI:image_version>

# run it
docker run -d -p 8501:8501 <ECR_repository_URI:image_version>


# Once the container is running, access the Streamlit app by visiting 
# http://<ec2-public-ip>:8501
# in your web browser, replacing 
# <ec2-public-ip>
# with the public IP address of your EC2 instance. NOTE! its HTTP not HTTPS

# Test the chat - it will likely generate some type of error
# Add additional permissions
# This probably will happen throughout the process. In this case the EC2 Role needed access to Bedrock. Copy the browser error into Q and it will
# tell you what permissions to add and where

# check if it's running
docker ps

# stop the container
docker stop <container_id>

